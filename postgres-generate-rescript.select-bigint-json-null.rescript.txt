%%raw("async function selectBigintJsonNull(client) {
  const sql = `
	SELECT
			CAST(123 AS bigint) as big,
			'{\"a\":1}'::jsonb as payload,
			'[1,2,3]'::json as list,
			NULL as nothing
	`
  return client.query({ text: sql, rowMode: 'array' })
    .then((res) => res.rows.length > 0 ? mapArrayToSelectBigintJsonNullResult(res.rows[0]) : null)
}

function mapArrayToSelectBigintJsonNullResult(data) {
  const result = {
    big: data[0],
    payload: data[1],
    list: data[2],
    nothing: data[3],
  }
  return result
}
")

type selectBigintJsonNullResult = {
  big: Null.t<BigInt.t>,
  payload: JSON.t,
  list: JSON.t,
  nothing: Null.t<string>
}

external selectBigintJsonNull: (Pg.client) => promise<Null.t<selectBigintJsonNullResult>> = "selectBigintJsonNull"
let run: (Pg.client) => promise<Null.t<selectBigintJsonNullResult>> = (db) => {
  selectBigintJsonNull(db)
}
